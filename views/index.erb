<ul id="manuscript"></ul>

<input type="text" name="message" id="message" placeholder="Say something..." required="required" />


<div pub-key="pub-32d1b09f-63b7-4015-8e59-bd603a2ec66e" sub-key="sub-7e2e745c-c38c-11e0-a0a5-53ec83638759" ssl="off" origin="pubsub.pubnub.com" id="pubnub"></div>
<script src="http://cdn.pubnub.com/pubnub-3.1.min.js"></script>
<script>
	$(function(){
		var channel = "chatterbee-chat";
		
		PUBNUB.history({
		    // Set channel to 'example'
		    channel : channel,

		    // Set limit of returned
		    limit : 100

		// Set Callback Function when History Returns
		}, function(messages) {

		    // Show History
		    for(i in message)
			{
				$("#manuscript").append("<li>" + message[i] + "</li>");
			}

			scroll_to_bottom();
		});
	
		PUBNUB.subscribe({
		    channel  : channel,
		    callback : function(text) 
			{
				$("#manuscript").append("<li>" + text + "</li>");
				scroll_to_bottom();
			}
		});
		
		
		$("#message").bind("keyup", function(e){
			var code = (e.keyCode ? e.keyCode : e.which);
			
			if(code == 13)
			{
				PUBNUB.publish({
			        channel : channel, 
					message : $("#message").val()
			    });
			
				$("#message").val("");
			}
		});

	});
	
	
	function scroll_to_bottom()
	{
		$("#manuscript").animate({ scrollTop: $("#manuscript").attr("scrollHeight") }, 3000);
	}
</script>